#include <tunables/global>

profile onstar2mqtt_addon flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  # MAXIMUM PERMISSIVE MODE - Home Assistant Compatible
  # Generic profile for all OnStar2MQTT add-ons
  # This profile allows almost everything using HA-compatible syntax
  
  # Capabilities - all of them
  capability,
  
  # Signals - send and receive all signals
  signal (send),
  signal (receive),

  # Network - all types
  network inet stream,
  network inet dgram,
  network inet6 stream,
  network inet6 dgram,
  network netlink raw,
  network unix stream,
  network unix dgram,
  network unix seqpacket,

  # Files - very permissive
  file,
  
  # All paths with full permissions
  /** rwix,
  
  # Ptrace for Chromium
  ptrace (read,trace),
  
  # Unix domain sockets
  unix,
}
