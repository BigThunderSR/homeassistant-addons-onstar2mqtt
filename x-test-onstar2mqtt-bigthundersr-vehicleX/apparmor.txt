#include <tunables/global>

profile x_test_onstar2mqtt_bigthundersr_vehicle1 flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  # MAXIMUM PERMISSIVE MODE
  # This profile allows almost everything
  
  # Capabilities
  capability,
  
  # Signals
  signal (send) set=(kill,term,int,hup,cont),
  signal (receive) peer=unconfined,
  signal (receive) peer=*_x_test_onstar2mqtt_bigthundersr_vehicle1,

  # Network
  network inet stream,
  network inet dgram,
  network inet6 stream,
  network inet6 dgram,
  network netlink raw,
  network unix stream,
  network unix dgram,

  # Files - very permissive
  file,
  
  # Specific paths with full access
  /** rwix,
  
  # Ptrace
  ptrace (trace) peer=x_test_onstar2mqtt_bigthundersr_vehicle1,
  ptrace (read) peer=x_test_onstar2mqtt_bigthundersr_vehicle1,
  ptrace (trace) peer=unconfined,
}
